<!DOCTYPE html>
<html class="no-js" lang="en" data-ng-app="weebl">
    <head>
        <base href="{% url 'index' %}">
        <title data-ng-bind="title + ' | ' + data.site"></title>
        <meta charset="utf-8"> <!-- Do not change charset please - utf-8 is important for d3.js -->
        <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
        <meta name="description" content="{% block meta_description %}{% endblock %}" />
        <meta name="keywords" content="{% block meta_keywords %}{% endblock %}" />
        <meta name="author" content="Canonical" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=8">
        <![endif]-->
        <link rel="shortcut icon" href="{{ STATIC_URL }}img/favicon.ico" type="image/x-icon" />
        {% include "css-conf.html" %}
        {% include "js-conf.html" %}
    </head>

    <body data-ng-init="data.site = 'OIL'; data.user = '{{ user.username }}'; data.apikey = '{{ user.api_key.key }}'">
        <div class="wrapper maas-wrapper">
            <header class="banner global fixed" role="banner">
                <nav role="navigation" class="nav-primary nav-right">
                    <div class="logo">
                        <a class="logo-ubuntu" href="{% url 'index' %}">
                        <img width="110" height"10" src="{{ STATIC_URL }}img/logos/logo.svg" alt="OIL" />
                        </a>
                    </div>
                    <ul id="main-nav" class="nav">
                    </ul>
                    <ul id="right-nav" class="nav">

                        <!-- User Menu -->
                        <li id="user-link">
                            {% if user.is_authenticated %}
                                <a href="">
                                    <img src="{{ STATIC_URL }}img/icons/user_dark.png" alt="" class="normal">
                                    <img src="{{ STATIC_URL }}img/icons/user_light.png" alt="" class="hover">
                                    {{ user.get_full_name }}
                                </a>
                                <ul class="nav" id="user-options">
                                    {% if user.is_staff %}
                                        <li>
                                            <a href="{{ site }}/admin/">Admin</a>
                                        </li>
                                    {% endif %}
                                    <li>
                                        <a href='{{ site }}/logout'>Log out</a>
                                    </li>
                                </ul>
                            {% else %}
                                <a href="{{ site }}{% url 'social:begin' 'ubuntu' %}">Log in</a>
                            {% endif %}

                        </li>

                    </ul>
                </nav>
                <div class="nav-toggles">
                    <a href="#canonlist" class="nav-toggle open"></a>
                    <a href="#" class="nav-toggle close"></a>
                </div>
            </header>
            <main id="body">
                <div data-ng-controller="successRateController as successRate">
                    <header class="page-header margin-bottom" data-maas-sticky-header>
                        <div class="inner-wrapper">
                            <h1 class="page-header__title">
                                <span class="page-header__title--identicator" id="bulk-actions">
                                    <a href="#/successRate" data-ng-class="{ active: data.currentpage === 'successRate' }" data-ng-click="data.highlightTab('successRate')">Success Rate</a>
                                    <span class="divide"></span>
                                    <a href="#/bugs" data-ng-class="{ active: data.currentpage === 'bugs' }" data-ng-click="data.highlightTab('bugs')">Bugs</a>
                                    <span class="divide"></span>
                                    <a href="#/testRuns" data-ng-class="{ active: data.currentpage === 'testRuns' }" data-ng-click="data.highlightTab('testRuns')">Test Runs</a>
                                    <span class="power-status--power" data-ng-show="loading">
                                        <span class="loader"></span>
                                        Loading...
                                    </span>
                                </span>
                            </h1>
                        </div>
                    </header>

                    <div class="inner-wrapper">

                        <!-- accordion -->
                        {% if user.is_authenticated %}
                            <div class="accordion three-col maas-accordion" data-ng-show="data.show_filters">
                                <h3 class="accordion__title">Filter by</h3>
                                <div class="ng-hide accordion__tab" data-ng-show="1">
                                    <h4 class="accordion__tab-title maas-accordion-tab active">Date</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-class="{ active: data.isFilterActive('date', 'Last 24 Hours', 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('date', 'Last 24 Hours', 'successRate')">Last 24 Hours</a>
                                            </li>
                                            <li class="accordion__tab-item" data-ng-class="{ active: data.isFilterActive('date', 'Last 7 Days', 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('date', 'Last 7 Days', 'successRate')">Last 7 Days</a>
                                            </li>
                                            <li class="accordion__tab-item" data-ng-class="{ active: data.isFilterActive('date', 'Last 30 Days', 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('date', 'Last 30 Days', 'successRate')">Last 30 Days</a>
                                            </li>
                                            <li class="accordion__tab-item" data-ng-class="{ active: data.isFilterActive('date', 'Last Year', 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('date', 'Last Year', 'successRate')">Last Year</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="data.metadata.openstackversion.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab">OpenStack Release</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="opstackvers in data.metadata.openstackversion | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('openstackversion', opstackvers.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('openstackversion', opstackvers.name, 'successRate')">{$ opstackvers.name $}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="metadata.environment.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab">Environment</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="env in data.metadata.environment | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('environment', env.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('environment', env.name, 'successRate')">{$ env.name $}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="data.metadata.ubuntuversion.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab">Ubuntu Release</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="ubuvers in data.metadata.ubuntuversion | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('ubuntuversion', ubuvers.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('ubuntuversion', ubuvers.name, 'successRate')">{$ ubuvers.name $} ({$ ubuvers.number $})</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="data.metadata.compute.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab">Compute</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="compute in data.metadata.compute | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('compute', compute.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('compute', compute.name, 'successRate')">{$ compute.name $}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="data.metadata.sdn.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab">Networking</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="sdn in data.metadata.sdn | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('sdn', sdn.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('sdn', sdn.name, 'successRate')">{$ sdn.name $}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="data.metadata.blockstorage.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab" ng-class="active">Block Storage</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="blockstorage in data.metadata.blockstorage | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('blockstorage', blockstorage.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('blockstorage', blockstorage.name, 'successRate')">{$ blockstorage.name $}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="data.metadata.imagestorage.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab">Image Storage</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="imagestorage in data.metadata.imagestorage | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('imagestorage', imagestorage.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('imagestorage', imagestorage.name, 'successRate')">{$ imagestorage.name $}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="ng-hide accordion__tab" data-ng-show="data.metadata.database.length">
                                    <h4 class="accordion__tab-title maas-accordion-tab">Database</h4>
                                    <div class="accordion__tab-content">
                                        <ul class="accordion__tab-list">
                                            <li class="accordion__tab-item" data-ng-repeat="database in data.metadata.database | orderBy:['name']"  data-ng-class="{ active: data.isFilterActive('database', database.name, 'successRate') }">
                                                <a class="accordion__tab-link" href="" data-ng-click="data.updateFilter('database', database.name, 'successRate')">{$ database.name $}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        {% endif %}

                        <!-- main content -->
                        <div id="main-content" data-maas-error-overlay>
                            {% if not user.is_authenticated %}
                                <div id="content" class="nine-col last-col">
                                    <p>Please <a href="{{ site }}{% url 'social:begin' 'ubuntu' %}">log in</a> to see data.</p>
                                </div>
                            {% else %}
                                <!------------------------------------------------>


                                <div id="content" class="nine-col last-col" data-ng-show="data.show_search">
                                    <div id="search-bar" class="search">
                                        <input
                                            type="search" placeholder="Search test runs" class="search__input"
                                            data-ng-model="data.search" data-ng-change="data.updateSearch()"
                                            data-ng-class="{ error: !searchValid }"/>
                                        <input type="submit" class="search__submit"
                                            data-ng-class="{ close: data.search.length > 0 }"
                                            data-ng-click="data.clearSearch()" />
                                    </div>
                                </div>

                                <!------------------------------------------------>
                                <div data-ng-view></div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </main>

            <div class="footer-wrapper" data-maas-error-toggle>
                <footer class="global inner-wrapper clearfix">
                    <div class="legal clearfix">
                        <div class="legal-inner">
                            <p class="copy">OIL REST api v1<a href="/api">try in browser</a></p>
                            <p class="twelve-col copy">&copy; 2015 Canonical Ltd. Ubuntu and Canonical are registered trademarks of Canonical Ltd.</p>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
    </body>
</html>
